---
permalink: san-migration/concept_fli_online_migration.html 
sidebar: sidebar 
keywords: online, migration, workflow 
summary: オンライン移行ワークフローは、移行プロセスの実行フェーズで実行されます。次のオンラインワークフローの図は、ホスト、ファブリック、デスティネーションストレージ、ソースストレージで実行されるタスクを示しています。 
---
= オンライン移行ワークフロー
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
オンライン移行ワークフローは、移行プロセスの実行フェーズで実行されます。次のオンラインワークフローの図は、ホスト、ファブリック、デスティネーションストレージ、ソースストレージで実行されるタスクを示しています。

image::../media/online_migration_1.png[オンライン移行 1.]

オンラインワークフローのタスクを次の表に示します。

[cols="2*"]
|===
| コンポーネント | タスク 


 a| 
ホスト
 a| 
. すべてのファイルシステムがマウントされ、すべての LUN パスとアプリケーションが使用可能であることを確認します。
. * オプション：インポートする LUN が ESX 用の場合は、「付録 A ： ESX CAW / ATS の更新」を参照して、記載されている手順に従ってください。
. ホストを準備してシャットダウンします。
. デスティネーション LUN のホストの電源をオンにします。
. 新しい SAN ブート LUN を使用するように HBA を設定します（ SAN ブートのみ）。
. サードパーティ製 MPIO をアンインストールします。
. ネットアップホストソフトウェアをインストールし、マルチパスを設定します。
. SAN ブート LUN へのすべてのパスが正常であることを確認します（ SAN ブートのみ）。
. 新しいデバイスを反映するようにシステムファイルと構成を更新します。
. すべての LUN へのすべてのパスが正常であることを確認します。
. すべてのサービスを再度有効にし、ホストをリブートします（ホストが稼働状態に戻ったこと、すべてのファイルシステムがマウントされたこと、すべてのサービスが開始されたことを確認し
. 新しい SAN ブート LUN への 2 番目のパスで HBA を設定します（ SAN ブートのみ）。




 a| 
ファブリック
 a| 
. ホストとソースストレージのゾーニングを解除します。
. ホストからデスティネーションストレージへのゾーンを作成します。




 a| 
デスティネーションストレージ
 a| 
. ソースアレイと新しい LUN を検出します。
. ソース LUN を外部としてマークします。
. 外部 LUN を使用してデスティネーション LUN を作成します。
. ホストイニシエータ igroup を作成し、デスティネーション LUN を igroup にマッピングします。
. デスティネーション LUN をオフラインにします。
. ソースアレイの LUN マスキング（ igroup ）からホストを削除します。
. インポート関係を作成し、インポートジョブを開始します。
. 前述のホストの手順 4 を実行します（ホストを新しい LUN の場所に再マッピングします）。
. 接続を単一のパスに制限します（ SAN ブートのみ）。
. SAN ブート LUN をホストに割り当てます。この時点では、データ LUN の割り当ては行いません（ SAN ブートのみ）。
. 定期的な Snapshot コピーを作成して、デスティネーション SAN ブート LUN のロールバックを有効にします（ SAN ブートのみ）。
. SAN ブート LUN へのすべてのパスを有効にします（ SAN ブートのみ）。
. デスティネーション LUN をオンラインにします。
. Snapshot コピーを作成して、デスティネーション LUN のロールバックを有効にします。
. インポート関係を開始します（ソース LUN からデスティネーション LUN へのデータコピーを開始します）。
. 検証ジョブを作成し、インポート関係を停止します（オプション）。
. インポート関係を削除します。
. 外部 LUN 属性を false にマークします。




 a| 
ソースストレージ
 a| 
. ソース LUN をデスティネーションストレージに割り当てます。
. ソース LUN のホストへのマッピングを解除します。
. Snapshot コピーを作成して、デスティネーション LUN のロールバックを有効にします。
. デスティネーションストレージに割り当てられているソース LUN を削除します。


|===